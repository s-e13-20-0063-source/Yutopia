<script>
async function search() {
  const q = document.getElementById("q").value;
  const url = "https://api.duckduckgo.com/?q=" + encodeURIComponent(q) + "&format=json&no_redirect=1";

  const res = await fetch(url);
  const data = await res.json();

  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  // Wikipedia 的な要約
  if (data.AbstractText) {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <div class="title">${data.Heading}</div>
      <div class="snippet">${data.AbstractText}</div>
      <div class="url">${data.AbstractURL}</div>
    `;
    resultsDiv.appendChild(div);
  }

  // 関連トピック
  if (data.RelatedTopics) {
    data.RelatedTopics.forEach(item => {
      if (item.Text && item.FirstURL) {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="title"><a href="${item.FirstURL}" target="_blank">${item.Text}</a></div>
          <div class="url">${item.FirstURL}</div>
        `;
        resultsDiv.appendChild(div);
      }
    });
  }
}
</script>
